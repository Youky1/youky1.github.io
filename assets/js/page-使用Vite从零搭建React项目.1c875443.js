(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{565:function(s,a,e){"use strict";e.r(a);var t=e(1),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"使用-vite-从零搭建-react-项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-vite-从零搭建-react-项目"}},[s._v("#")]),s._v(" 使用 Vite 从零搭建 React 项目")]),s._v(" "),a("h2",{attrs:{id:"项目初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目初始化"}},[s._v("#")]),s._v(" 项目初始化")]),s._v(" "),a("p",[s._v("首先根据技术选型，挑选相应的模板。这里是使用 typescript 的 React 项目，因此初始化命令为：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" create vite@latest my-app -- "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--template")]),s._v(" react-ts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后下载依赖：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" my-app\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("运行项目：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("npx vite\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("整个过程非常之快，运行也非常流畅。Vite 的快名不虚传。")]),s._v(" "),a("h2",{attrs:{id:"使用-eslint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-eslint"}},[s._v("#")]),s._v(" 使用 eslint")]),s._v(" "),a("p",[s._v("这里选用 google 的 gts 作为规则，运行初始化命令：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("npx gts init\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后一路按 y，下载完相关依赖。")]),s._v(" "),a("p",[s._v("然后，此时就可以运行 gts 提供的相关命令了，如检查代码是否符合规范：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run lint\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"可能的坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可能的坑"}},[s._v("#")]),s._v(" 可能的坑")]),s._v(" "),a("ol",[a("li",[a("p",[s._v('如果 eslint 出现报错"vite" is not published 和"@vitejs/plugin-react" is not published，则需要在 package.json 中把这两个依赖从 '),a("code",[s._v("devDependencies")]),s._v("移到 "),a("code",[s._v("dependencies")]),s._v(" 内。")])]),s._v(" "),a("li",[a("p",[s._v("如果报错不能使用 jsx，则需要"),a("code",[s._v("tsconfig.compilerOptions")]),s._v("中配置"),a("code",[s._v('"jsx": "react"')])])]),s._v(" "),a("li",[a("p",[s._v("如果使用 document 的地方报错"),a("code",[s._v("找不到名称“document”")]),s._v("，则需要配置"),a("code",[s._v('"lib": ["esnext", "DOM"]')])])])]),s._v(" "),a("h2",{attrs:{id:"使用-prettier"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-prettier"}},[s._v("#")]),s._v(" 使用 Prettier")]),s._v(" "),a("p",[a("code",[s._v("Prettier")]),s._v("用于格式化代码，在成熟的项目中都会用它来达到代码风格的统一。")]),s._v(" "),a("p",[s._v("添加首先在 vscode 中下载 "),a("code",[s._v("Prettier - Code formatter")]),s._v(" 插件，是为了便于我们在开发过程中时刻注意规范代码。这里也可以打开 vscode 的保存时自动格式化功能")]),s._v(" "),a("p",[s._v("安装 gts 后，会生成 "),a("code",[s._v(".prettierrc.js")]),s._v(" 文件，引用 gts 的规则：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gts/.prettierrc.json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"使用-husky"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-husky"}},[s._v("#")]),s._v(" 使用 husky")]),s._v(" "),a("p",[a("code",[s._v("husky")]),s._v(" 用于使用 git 钩子，来在某些阶段自动执行某些操作（比如在 commit 前执行 gts lint）。")]),s._v(" "),a("p",[s._v("首先下载依赖：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" husky "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("添加 npm 命令：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" set-script prepare "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"husky install"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run prepare\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("添加自定义钩子。"),a("code",[s._v("pre-commit")]),s._v(" 表示钩子执行时机。后面的"),a("code",[s._v("npm run lint")]),s._v(" 代表每次钩子执行的操作。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("npx husky "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" .husky/pre-commit "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run lint"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("来测试一下，我们首先在文件中添加一行无效代码"),a("code",[s._v("let a = 0;")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'husky error test'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("运行结果：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":5  warning  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a'")]),s._v(" is assigned a value but never used        @typescript-eslint/no-unused-vars\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":5  error    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a'")]),s._v(" is never reassigned. Use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'const'")]),s._v(" instead  prefer-const\n\n✖ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" problems "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" error, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" error and "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" warnings potentially fixable with the "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--fix")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" option.\n\nhusky - pre-commit hook exited with code "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("可见正确执行了 pre-commit 钩子，进行了检查，并且在检查不通过的情况下 commit 没有成功。")]),s._v(" "),a("p",[s._v("对于可以自动修复的错误（比如末尾没加分号），"),a("code",[s._v("gts lint")]),s._v("会进行自动修复，因此开发者是没有感知的。")])])}),[],!1,null,null,null);a.default=n.exports}}]);