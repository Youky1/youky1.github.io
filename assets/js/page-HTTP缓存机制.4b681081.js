(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{675:function(v,_,a){"use strict";a.r(_);var t=a(1),e=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"http缓存机制"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#http缓存机制"}},[v._v("#")]),v._v(" HTTP缓存机制")]),v._v(" "),_("h2",{attrs:{id:"缓存的分类"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#缓存的分类"}},[v._v("#")]),v._v(" 缓存的分类")]),v._v(" "),_("p",[v._v("首先通过"),_("code",[v._v("cache-control")]),v._v("字段判断缓存数据是否过期：")]),v._v(" "),_("ul",[_("li",[v._v("若缓存可用，直接使用")]),v._v(" "),_("li",[v._v("否则进入"),_("strong",[v._v("协商缓存")]),v._v("阶段，发送HTTP请求，服务端通过"),_("code",[v._v("If-Modified-since")]),v._v("或"),_("code",[v._v("If-None-Match")]),v._v("字段检查是否更新\n"),_("ul",[_("li",[v._v("若资源未更新：返回"),_("code",[v._v("304")]),v._v("，告诉浏览器从缓存中读取数据")]),v._v(" "),_("li",[v._v("若资源更新：返回"),_("code",[v._v("200")]),v._v("，并附带资源")])])])]),v._v(" "),_("p",[v._v("用到的字段：")]),v._v(" "),_("ul",[_("li",[v._v("强制缓存："),_("code",[v._v("cache-control")])]),v._v(" "),_("li",[v._v("协商缓存：\n"),_("ul",[_("li",[_("code",[v._v("ETag")])]),v._v(" "),_("li",[_("code",[v._v("Last-Modified")])])])])]),v._v(" "),_("h2",{attrs:{id:"实现缓存机制的有关字段"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#实现缓存机制的有关字段"}},[v._v("#")]),v._v(" 实现缓存机制的有关字段")]),v._v(" "),_("h3",{attrs:{id:"cache-control"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cache-control"}},[v._v("#")]),v._v(" cache-control")]),v._v(" "),_("p",[_("strong",[v._v("作为请求字段")]),v._v("：")]),v._v(" "),_("ul",[_("li",[v._v("no-cache：不使用缓存，强制向服务器进行确认")]),v._v(" "),_("li",[v._v("max-age：最多缓存多久。取值为相对值，相对于资源被请求时服务器记录的时间")]),v._v(" "),_("li",[v._v("only-if-cached："),_("strong",[v._v("仅")]),v._v("从缓存获取资源")])]),v._v(" "),_("p",[_("strong",[v._v("作为响应字段")]),v._v("：")]),v._v(" "),_("ul",[_("li",[v._v("public/private：是否允许中间服务器进行缓存")]),v._v(" "),_("li",[v._v("no-cache：客户端后续每次请求必须先向服务器确定资源的有效性。若资源未改变则返回304，客户端再使用缓存数据")]),v._v(" "),_("li",[v._v("no-store：不进行缓存，每次都向服务器请求资源，返回数据和200")])]),v._v(" "),_("h3",{attrs:{id:"if-modified-since"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#if-modified-since"}},[v._v("#")]),v._v(" If-Modified-Since")]),v._v(" "),_("p",[v._v("用于"),_("strong",[v._v("请求头")]),v._v("中，和响应中的"),_("code",[v._v("last-modified")]),v._v("对应，表明能接受的最后更新时间")]),v._v(" "),_("h3",{attrs:{id:"last-modified"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#last-modified"}},[v._v("#")]),v._v(" Last-Modified")]),v._v(" "),_("p",[v._v("资源最后的修改时间。")]),v._v(" "),_("p",[v._v("如果编辑了文件，但其实内容没有修改，也会造成缓存失效。")]),v._v(" "),_("h3",{attrs:{id:"if-none-match"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#if-none-match"}},[v._v("#")]),v._v(" If-None-Match")]),v._v(" "),_("p",[v._v("取值为服务器返回的ETag字段的内容，比较ETag是否发生变化和响应中的"),_("code",[v._v("ETag")]),v._v("对应。")]),v._v(" "),_("p",[v._v("比"),_("code",[v._v("If-Modified-Since")]),v._v("优先级更高")]),v._v(" "),_("h3",{attrs:{id:"etag"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#etag"}},[v._v("#")]),v._v(" ETag")]),v._v(" "),_("p",[v._v("资源的唯一标识。编辑了文件但未改变内容时，ETag不会改变")]),v._v(" "),_("blockquote",[_("p",[v._v("ETag如何生成？")])]),v._v(" "),_("p",[v._v("没有明确的生成办法，一般使用"),_("code",[v._v("内容")]),v._v("和"),_("code",[v._v("最后修改时间")]),v._v("的散列值")]),v._v(" "),_("h3",{attrs:{id:"only-if-cached"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#only-if-cached"}},[v._v("#")]),v._v(" only-if-cached")]),v._v(" "),_("p",[v._v("客户端只接受缓存数据，不向源服务器请求")]),v._v(" "),_("h2",{attrs:{id:"代理缓存"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#代理缓存"}},[v._v("#")]),v._v(" 代理缓存")]),v._v(" "),_("h3",{attrs:{id:"意义"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#意义"}},[v._v("#")]),v._v(" 意义")]),v._v(" "),_("p",[v._v("通过在代理服务器进行缓存，减少源服务器的压力。")]),v._v(" "),_("p",[v._v("但对于私密数据，一般不会进行代理缓存。")]),v._v(" "),_("h3",{attrs:{id:"涉及到的字段"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#涉及到的字段"}},[v._v("#")]),v._v(" 涉及到的字段")]),v._v(" "),_("ul",[_("li",[v._v("开启代理缓存："),_("code",[v._v("Cache-Control: public")])]),v._v(" "),_("li",[v._v("控制缓存在代理服务器中的有效时间："),_("code",[v._v("s-maxage")])])])])}),[],!1,null,null,null);_.default=e.exports}}]);