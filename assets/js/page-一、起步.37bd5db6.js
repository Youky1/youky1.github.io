(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{659:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"一、起步"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、起步"}},[s._v("#")]),s._v(" 一、起步")]),s._v(" "),t("h2",{attrs:{id:"_1-1-下载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-下载"}},[s._v("#")]),s._v(" 1.1 下载")]),s._v(" "),t("p",[s._v("安装本体：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yarn add mobx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("对于React应用绑定包有两种，只支持函数组件的 "),t("code",[s._v("mobx-react-lite")]),s._v(" 和同时也支持类组件的 "),t("code",[s._v("mobx-react")]),s._v(" 。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yarn add mobx-react-lite\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_1-2-装饰符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-装饰符"}},[s._v("#")]),s._v(" 1.2 装饰符")]),s._v(" "),t("p",[s._v("在MobX6版本中，默认移除了 "),t("code",[s._v("@observable")]),s._v(" 等修饰符写法来最大限度的兼容JS，若要使用修饰符可以手动开启。")]),s._v(" "),t("h2",{attrs:{id:"_1-3-生产环境检测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-生产环境检测"}},[s._v("#")]),s._v(" 1.3 生产环境检测")]),s._v(" "),t("p",[s._v("通过环境变量 "),t("code",[s._v("process.env.NODE_ENV")]),s._v("  来检测是否出于生产环境。此时一些安全检查将不会生效。")]),s._v(" "),t("h2",{attrs:{id:"_1-4-核心概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-核心概念"}},[s._v("#")]),s._v(" 1.4 核心概念")]),s._v(" "),t("p",[s._v("MobX将应用分为三个核心概念：")]),s._v(" "),t("ul",[t("li",[s._v("State（状态）：驱动应用程序的数据，可以是任意类型")]),s._v(" "),t("li",[s._v("Actions（动作）：改变State的代码")]),s._v(" "),t("li",[s._v("Derivations（派生）：依托于 "),t("code",[s._v("State")]),s._v(" 的代码，主要分为两种\n"),t("ul",[t("li",[t("em",[s._v("Computed")]),s._v(" ：由一个"),t("strong",[s._v("纯函数")]),s._v("从State中计算得来")]),s._v(" "),t("li",[t("em",[s._v("Reactions")]),s._v(" ：State变化时自动执行的副作用（包括对于React组件的更新，和类似Vue中的watch的效果）")])])])]),s._v(" "),t("h2",{attrs:{id:"_1-5-基本原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-基本原则"}},[s._v("#")]),s._v(" 1.5 基本原则")]),s._v(" "),t("ol",[t("li",[s._v("所有的 "),t("code",[s._v("derivations")]),s._v("  将会在 "),t("code",[s._v("state")]),s._v(" 改变后自动、同步更新，在其中可以安全的使用 "),t("code",[s._v("computed")])]),s._v(" "),t("li",[t("code",[s._v("computed")]),s._v(" 是"),t("strong",[s._v("惰性")]),s._v("的，在使用它们的副作用发生前都是不激活的")]),s._v(" "),t("li",[t("code",[s._v("computed")]),s._v(" 是纯函数，并且不能修改 "),t("code",[s._v("state")])])]),s._v(" "),t("h1",{attrs:{id:"二、state"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、state"}},[s._v("#")]),s._v(" 二、State")]),s._v(" "),t("h2",{attrs:{id:"_2-1-makeobservable"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-makeobservable"}},[s._v("#")]),s._v(" 2.1 makeObservable")]),s._v(" "),t("p",[s._v("任何JS变量都可以变为可观察对象。")]),s._v(" "),t("p",[s._v("最基本的转换方法是 "),t("code",[s._v("makeObservable")]),s._v("  ，传入一个对象，并对每个值进行注解：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("observable")]),s._v(" 定义一个存储 state 的可追踪字段。")]),s._v(" "),t("li",[t("code",[s._v("action")]),s._v(" 将一个方法标记为可以修改 "),t("code",[s._v("state")]),s._v(" 的 "),t("code",[s._v("action")]),s._v("。")]),s._v(" "),t("li",[t("code",[s._v("computed")]),s._v(" 标记一个可以由 "),t("code",[s._v("state")]),s._v(" 派生出新的值并且缓存其输出的 getter。")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" makeObservable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" observable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" computed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mobx"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Doubler")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    value\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("constructor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("makeObservable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" observable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("double")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" computed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("increment")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" value\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("double")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("increment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h2",{attrs:{id:"_2-2-makeautoobservable"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-makeautoobservable"}},[s._v("#")]),s._v(" 2.2 makeAutoObservable")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("makeAutoObservable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" overrides"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("自动对所有属性做推断，可以在 "),t("code",[s._v("overrides")]),s._v(" 中对具体属性做特殊注解，标记为false的成员不会添加注解")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" makeAutoObservable "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mobx"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createDoubler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("makeAutoObservable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("double")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("increment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h2",{attrs:{id:"_2-3-observable"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-observable"}},[s._v("#")]),s._v(" 2.3 observable")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("observable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("source"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" overrides"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("调用后会克隆 source 参数并将其所有属性变为可观察的。")]),s._v(" "),t("p",[s._v("与上面两种方法的区别：使用Proxy创建一个可观察的副本对象，因此"),t("strong",[s._v("调用后添加的属性也是可观察的")]),s._v("。")]),s._v(" "),t("h1",{attrs:{id:"三、actions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、actions"}},[s._v("#")]),s._v(" 三、Actions")])])}),[],!1,null,null,null);t.default=e.exports}}]);